<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <link rel="stylesheet" href="/assembly/css/css.css"/>
    <script src="/plugins/jquery/jquery-1.9.1.min.js"></script>
    <link href="/assembly/css/style.css" rel="stylesheet" type="text/css"/>
    <link rel="stylesheet" type="text/css" href="/assembly/css/easyui.css">
    <link rel="stylesheet" type="text/css" href="/assembly/css/icon.css">
    <script src="/plugins/easyui-1.5.5.7/jquery.min.js"></script>
    <script src="/plugins/jquery/jquery.json.min.js"></script>
    <script src="/plugins/easyui-1.5.5.7/jquery.easyui.min.js"></script>
    <script src="/plugins/easyui-1.5.5.7/locale/easyui-lang-zh_CN.js"></script>
    <script src="/plugins/moment.min.js"></script>
    <script src="/js/utils.js"></script>
    <script src="/js/cookieUtil.js"></script>
    <script src="/js/easy_common.js"></script>
</head>
<style>
    p {
        margin: 10px;
    }

    .showLine {
        background: ghostwhite;
        padding: 10px 0 0 50px;
        width: 899px;
        margin-bottom: 10px;
    }

    .showLine p {
        display: inline-block;
        width: 30%;
    }

    p label {
        display: inline-block;
        width: 80px;
        text-align: right;
    }

    .showV {
        float: left;
        padding: 10px;
        background: ghostwhite;
        margin-right: 20px;
    }

    #savePage div {
    }
</style>
<body>
<div id="tabs" class="easyui-tabs" data-options="fit:true,plain:true" style="padding:10px;">
    <div id="tabs1" title="质保书设置" style="padding:10px;">
        <form id="form">
            <!-- 质保书资料 -->
            <div style="width:40%; float:left; margin:0px;">
                <div class="di3"><span
                        style="background-color:#FFF; padding-right:10px; font-size:15px; font-weight:600;">质保书资料</span>
                </div>
                <input type="hidden" name="id" id="id">
                <input type="hidden" name="clerkId">
                <input type="hidden" name="customerId">
                <input type="hidden" name="processCardId" id="processCardId">
                <table width="100%" border="0" cellspacing="0" cellpadding="0" class="ftgyk_table3">
                    <tr>
                        <td width="20%">订货编号</td>
                        <td><input class="easyui-validatebox textbox" required="true" name="orderNo" type="text"
                                   style="height:35px; width:160px;"/></td>
                    </tr>
                    <tr>
                        <td>指令号</td>
                        <td><input class="easyui-validatebox textbox" required="true" name="code" type="text" id="code"
                                   readonly
                                   style="height:35px; width:160px;"/>
                            <a href="javascript:void(0)"><img src="/assembly/images/ck.png"
                                                              style="display: inline-block;border: none; vertical-align: middle;"
                                                              onclick="selectOtherPage('工艺卡','/processCard/ftCard.html',null,selectCode)"/></a>
                        </td>
                    </tr>
                    <tr>
                        <td>检验员</td>
                        <td><input class="easyui-validatebox textbox" required="true" name="clerk" type="text"
                                   style="height:35px; width:160px;"/>
                            </select></td>
                    </tr>
                    <tr>
                        <td valign="top">设计</td>
                        <td><input class="easyui-validatebox textbox" required="true" name="design" type="text"
                                   style="height:35px; width:160px;"/>

                        </td>
                    </tr>
                    <tr>
                        <td valign="top">成型方式</td>
                        <td>
                            <input class="easyui-validatebox textbox" required="true" name="processingMethod"
                                   type="text"
                                   style="height:35px; width:160px;"/>
                            <a href="javascript:void(0)"><img src="/assembly/images/ck.png"
                                                              style="display: inline-block;border: none; vertical-align: middle;"
                                                              onclick="selectOtherPage('加工方法','/base/processingMethod.html',null,selectProcessingMethod)"/></a>
                        </td>
                    </tr>
                    <tr>
                        <td valign="top">拼接</td>
                        <td>
                            <input class="easyui-combobox"
                                   name="splicing"
                                   style="height:35px; height:35px; width:160px;"
                                   id="splicing"
                                   editable="false"
                                   data-options="panelHeight:'auto',valueField:'id', textField:'text'"/>
                        </td>
                    </tr>
                    <tr>
                        <td valign="top">客户</td>
                        <td><input class="easyui-validatebox textbox" required="true" name="customer" id="customer"
                                   type="text"
                                   style="height:35px; width:160px;"/>
                            <a href="javascript:void(0)"><img src="/assembly/images/ck.png"
                                                              style="display: inline-block;border: none; vertical-align: middle;"
                                                              onclick="selectOtherPage('客户选择','/base/gysgl/khgl.html',null,selectCustomer)"/></a>
                        </td>
                    </tr>
                    <tr>
                        <td valign="top">数量</td>
                        <td>
                            <input class="easyui-validatebox textbox" required="true" name="num" type="text"
                                   style="height:35px; width:160px"/></td>
                    </tr>
                </table>
            </div>

            <!-- 出具报告 -->
            <div style="width:59.5%; float:left;margin-left:0.5%">
                <div class="di3"><span
                        style="background-color:#FFF; padding-right:10px; font-size:15px; font-weight:600;">出具报告</span>
                </div>
                <table width="100%" border="0" cellspacing="0" cellpadding="0" class="ftgyk_table4">
                    <tr>
                        <td align="right">
                            <input class="easyui-validatebox textbox" required="true" name="qualityReport"
                                   type="checkbox"
                                   id="qualityReport" value="1">
                        </td>
                        <td>质量检验报告</td>
                        <td align="right">图号</td>
                        <td><input class="easyui-validatebox textbox" required="true" name="qualityDesc" type="text"
                                   style="height:35px; width:160px;"/></td>
                    </tr>
                    <tr>
                        <td align="right"><input class="easyui-validatebox textbox" required="true" name="qualityProve"
                                                 type="checkbox" id="qualityProve" value="1"></td>
                        <td>材料质量证明书</td>
                        <td align="right">热处理</td>
                        <td>
                            <input class="easyui-combobox"
                                   name="heatTreatmentType"
                                   id="heatTreatmentType"
                                   style="height:35px; height:35px; width:160px;"
                                   editable="false"
                                   data-options="panelHeight:'auto',valueField:'id', textField:'text'"/>
                        </td>
                    </tr>
                    <tr>
                        <td align="right"><input class="easyui-validatebox textbox" required="true" name="rtReport"
                                                 type="checkbox" id="rtReport" value="1"></td>
                        <td>RT报告</td>
                        <td align="right">备注</td>
                        <td><input class="easyui-validatebox textbox" required="true" name="reportDesc" type="text"
                                   style="height:35px;width:160px;"/>
                        </td>
                    </tr>

                    <tr>
                        <td align="right" valign="top">
                            <input class="easyui-validatebox textbox" required="true" name="pt"
                                   type="checkbox" id="pt" value="1">
                        </td>
                        <td>PT报告</td>
                        <td align="right">
                            焊缝质量
                        </td>
                        <td>
                            <select id="weldQuality" data-options="panelHeight:'auto'" class="easyui-combobox" name="weldQuality" style="width:160px;">
                                <option value=""></option>
                                <option value="合格">合格</option>
                                <option value="不合格">不合格</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td align="right" valign="top">
                            <input class="easyui-validatebox textbox" required="true"
                                   type="checkbox"
                                   name="ut" id="ut" value="1">
                        </td>
                        <td>UT报告</td>
                        <td align="right"></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td align="right" valign="top"><input class="easyui-validatebox textbox" required="true"
                                                              type="checkbox"
                                                              name="mt" id="mt" value="1"></td>
                        <td>MT报告</td>
                        <td align="right"></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td align="right" valign="top"><input class="easyui-validatebox textbox" required="true"
                                                              name="detection" type="checkbox" id="detection" value="1">
                        </td>
                        <td>监检证书</td>
                        <td align="right">复合板</td>
                        <td><input class="easyui-validatebox textbox" required="true" name="compositeBoard" type="text"
                                   style="height:35px; width:160px;"/></td>
                    </tr>
                    <tr>
                        <td align="right" valign="top"><input class="easyui-validatebox textbox" required="true"
                                                              name="materialRetest" type="checkbox" id="materialRetest"
                                                              value="1"></td>
                        <td>材料复验报告</td>
                        <td align="right">备注</td>
                        <td><input class="easyui-validatebox textbox" required="true" name="materialRetestDesc"
                                   type="text"
                                   style="height:35px;width: 160px;"
                                   value="详见报告"/></td>
                    </tr>
                    <tr>
                        <td align="right" valign="top"><input class="easyui-validatebox textbox" required="true"
                                                              type="checkbox"
                                                              name="boardPerformance" id="boardPerformance"
                                                              value="1"></td>
                        <td>焊接试板报告</td>
                        <td align="right">备注</td>
                        <td><input class="easyui-validatebox textbox" required="true" name="boardPerformanceDesc"
                                   type="text"
                                   style="height:35px;width: 160px;"
                                   value="详见报告"/></td>
                    </tr>
                    <tr>
                        <td align="right" valign="top"><input class="easyui-validatebox textbox" required="true"
                                                              name="heatTreatment" type="checkbox" id="heatTreatment"
                                                              value="1">
                        </td>
                        <td>热处理报告</td>
                        <td align="right">备注</td>
                        <td><input class="easyui-validatebox textbox" required="true" name="heatTreatmentDesc"
                                   type="text"
                                   style="height:35px;width: 160px;"
                                   value="详见报告"/></td>
                    </tr>
                </table>

            </div>

            <!-- 出具报告 -->
            <div style="width:100%; margin-top:5px; float:left">
                <table width="100%" border="0" cellspacing="0" cellpadding="0">
                    <tr>
                        <td>
                            <div class="mainbox2">
                                <div class="idTabs4">
                                    <ul class="tab4">
                                        <li><a style="cursor:hand" class="selected" onclick="tableChange()">常规产品</a>
                                        </li>
                                        <li><a style="cursor:hand" class="" onclick="tableChange()">锥体参数</a></li>
                                    </ul>
                                </div>
                            </div>
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <div class="items">
                                <!-- 常规参数 -->
                                <div id="sm1" style="display:block;">
                                    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="ftgyk_table4">
                                        <tr>
                                            <td align="center" align="right">
                                            <td width="8%" align="right"><input type="checkbox" value="1"
                                                                                name="shapeOnly">仅形状
                                            </td>
                                            <td>
                                                <input class="easyui-validatebox textbox" required="true" name="shape"
                                                       id="shape"
                                                       type="text"
                                                       style="height:35px;width: 160px;"
                                                       value="详见报告"/>
                                            </td>
                                            <td colspan="2" width="8%" align="right">来源</td>
                                            <td width="8%">
                                                <input class="easyui-combobox"
                                                       name="materialSource"
                                                       style="height:35px; height:35px; width:160px;"
                                                       id="materialSource"
                                                       editable="false"
                                                       data-options="panelHeight:'auto',valueField:'id', textField:'text'"/>
                                            </td>
                                            <td width="10%">&nbsp;</td>
                                            <td width="20%">&nbsp;</td>
                                        </tr>
                                        <tr>
                                            <td align="center"></td>
                                            <td align="right"><input type="checkbox" name="diameterStandard" value="1"
                                                                     id="diameterStandard">内直径
                                            </td>
                                            <td><input class="easyui-validatebox textbox" required="true"
                                                       name="diameter" id="diameter"
                                                       type="text" class="dfinput" style="height:35px; width:160px;"/>
                                            </td>
                                            <td colspan="2" align="right">材质</td>
                                            <td colspan="3"><input class="easyui-validatebox textbox" required="true"
                                                                   name="material" type="text"
                                                                   style="height:35px; width:160px;"/>
                                                <input type="hidden" id="materialId" name="materialId"/>
                                                <a href="javascript:void(0)"><img src="/assembly/images/ck.png"
                                                                                  style="display: inline-block;border: none; vertical-align: middle;"
                                                                                  onclick="selectOtherPage('材质选择','/base/materialSetting.html',null,selectMaterial)"/></a>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td align="center">&nbsp;</td>
                                            <td align="right">壁厚</td>
                                            <td><input class="easyui-validatebox textbox" required="true"
                                                       name="thickness" type="text"
                                                       style="height:35px; width:160px;"/>
                                            </td>
                                            <td colspan="2" align="right">最小壁厚</td>
                                            <td><input class="easyui-validatebox textbox" required="true"
                                                       name="min" type="text"
                                                       style="height:35px; width:160px;"/>
                                            </td>
                                            <td align="right"> 直边</td>
                                            <td align="left"><input class="easyui-validatebox textbox" required="true"
                                                                    name="straightEdge" type="text"
                                                                    style="height:35px; width:160px;"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td align="center">&nbsp;</td>
                                            <td>&nbsp;</td>
                                            <td>&nbsp;</td>
                                            <td colspan="2" align="right">重量</td>
                                            <td><input class="easyui-validatebox textbox" required="true"
                                                       name="weight" type="text"
                                                       style="height:35px; width:160px;"/>
                                            </td>
                                            <td align="right">失圆度</td>
                                            <td align="left"><input class="easyui-validatebox textbox" required="true"
                                                                    name="roundness" type="text"
                                                                    style="height:35px; width:160px;"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td align="center"></td>
                                            <td align="right"><input type="checkbox" value="1"
                                                                     name="circumferenceStandard1"
                                                                     id="circumferenceStandard1">外圆周长
                                            </td>
                                            <td><input class="easyui-validatebox textbox" required="true"
                                                       name="circumference1" type="text"
                                                       style="height:35px; width:160px;"/>
                                            </td>
                                            <td colspan="2" align="right">
                                                <input type="checkbox" name="toleranceStandard1" value="1"
                                                       id="toleranceStandard1">
                                                周长公差
                                            </td>
                                            <td colspan="3">
                                                <input class="easyui-validatebox textbox" required="true"
                                                       name="toleranceMin1" type="text"
                                                       style="height:35px; width:160px;"/>
                                                -
                                                <input class="easyui-validatebox textbox" required="true"
                                                       name="toleranceMax1" type="text"
                                                       style="height:35px; width:160px;"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td align="center"></td>
                                            <td align="right"><input value="1" type="checkbox" name="heightStandard"
                                                                     id="heightStandard">总高
                                            </td>
                                            <td><input class="easyui-validatebox textbox" required="true"
                                                       name="height"
                                                       type="text" class="dfinput" style="height:35px; width:160px;"/>
                                            </td>
                                            <td colspan="2" align="right">总高公差</td>
                                            <td colspan="3">
                                                <input class="easyui-validatebox textbox" required="true"
                                                       name="totalHeight1" type="text"
                                                       style="height:35px; width:160px;"/>
                                                -
                                                <input class="easyui-validatebox textbox" required="true"
                                                       name="totalHeight2" type="text"
                                                       style="height:35px; width:160px;"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td align="center">&nbsp;</td>
                                            <td align="right">制造标准</td>
                                            <td colspan="2">
                                                <input class="easyui-combobox"
                                                       name="manufacture"
                                                       style="height:35px; height:35px; width:160px;"
                                                       id="manufacture"
                                                       data-options="panelHeight:'auto',valueField:'id', textField:'text'"/>
                                            </td>
                                            <td width="5%" align="right">出厂</td>
                                            <td colspan="3">
                                                <input class="easyui-combobox"
                                                       name="outFactory"
                                                       style="height:35px; height:35px; width:160px;"
                                                       id="outFactory"
                                                       editable="false"
                                                       data-options="panelHeight:'auto',valueField:'id', textField:'text'"/>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                                <!-- 锥体参数 -->
                                <div id="sm2" style="display: none;">
                                    <table width="100%" border="0" cellspacing="0" cellpadding="0" class="ftgyk_table4">
                                        <tr>
                                            <td align="right">下口直径</td>
                                            <td>
                                                <input class="easyui-validatebox textbox" required="true"
                                                       name="downDiameter" type="text"
                                                       style="height:35px;width: 160px;"
                                                />
                                            </td>
                                            <td align="right">下口直边</td>
                                            <td>
                                                <input class="easyui-validatebox textbox" required="true"
                                                       name="downStraight" type="text"
                                                       style="height:35px;width: 160px;"
                                                />
                                            </td>
                                        </tr>
                                        <tr>
                                            <td align="right">锥角</td>
                                            <td>
                                                <input class="easyui-validatebox textbox" required="true"
                                                       name="coneAngle" type="text"
                                                       style="height:35px;width: 160px;"
                                                />
                                            </td>
                                            <td align="right">小r</td>
                                            <td>
                                                <input class="easyui-validatebox textbox" required="true"
                                                       name="littleR" type="text"
                                                       style="height:35px;width: 160px;"
                                                />
                                            </td>
                                        </tr>
                                        <tr>
                                            <td align="right">下破口</td>
                                            <td>
                                                <input class="easyui-validatebox textbox" required="true"
                                                       name="downGroove" type="text"
                                                       style="height:35px;width: 160px;"
                                                />
                                            </td>
                                            <td align="right"></td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td align="right"><input type="checkbox" value="1" name="">下口外圆</td>
                                            <td>
                                                <input class="easyui-validatebox textbox" required="true"
                                                       name="downDiameter" type="text"
                                                       style="height:35px;width: 160px;"/>
                                            </td>
                                            <td align="right">同心率</td>
                                            <td>
                                                <input class="easyui-validatebox textbox" required="true"
                                                       name="concentric" type="text"
                                                       style="height:35px;width: 160px;"/>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td align="right"><input type="checkbox" value="1"
                                                                     name="toleranceStandard2">周长公差
                                            </td>
                                            <td>
                                                <input class="easyui-validatebox textbox" required="true"
                                                       name="downDiameter" type="text"
                                                       style="height:35px;width: 160px;"/>
                                                -
                                                <input class="easyui-validatebox textbox" required="true"
                                                       name="concentric" type="text"
                                                       style="height:35px;width: 160px;"/>
                                            </td>
                                            <td align="right"></td>
                                            <td>
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                        </td>
                    </tr>
                </table>
            </div>

            <!-- table -->
            <div style="width:100%; margin-top:5px; float:left">
                <table id="dg" style="width:80%"></table>
                <div id="toolbar">
                    <a href="javascript:void(0)" class="easyui-linkbutton"
                       onclick="addBtn('新增', '/quality/qualityDetailAdd.html')"
                       data-options="plain:true,iconCls:'icon-add'">新增</a>
                    <a href="#" class="easyui-linkbutton"
                       onclick="editBtn('修改', '/quality/qualityDetailAdd.html')"
                       data-options="plain:true,iconCls:'icon-edit'">修改</a>
                    <a href="#" class="easyui-linkbutton" onclick="delBtn('删除','/quality/book/deleteDetail')"
                       data-options="plain:true,iconCls:'icon-remove'">删除</a>
                    <a href="#" class="easyui-linkbutton" onclick="distribution('分配')"
                       data-options="plain:true,iconCls:'icon-more'">分配</a>
                    <a href="#" class="easyui-linkbutton" onclick="distribution('')"
                       data-options="plain:true,iconCls:'icon-remove'">取消分配</a>
                </div>
            </div>

            <!-- footer -->
            <div class="cyda" style="margin-top:10px; border-top:1px dashed #666666">
                <ul class="cyda_cx">
                    <li>
                        <label>填表</label>
                        <input id="createUser" name="createUser" type="hidden">
                        <input class="easyui-validatebox textbox" readonly name="createUserName" id="createUserName"
                               type="text" class="dfinput" style="height:30px; width:160px;"/>
                    </li>
                    <li>
                        <label>制作日</label>
                        <input name="createTime" id="createTime" readonly type="text" class="easyui-datebox"
                               style="height:30px; width:160px;"/>
                    </li>
                </ul>
            </div>

        </form>
    </div>
</div>
</div>
</body>
</html>
<script src="/assembly/layer/layer.js"></script>
<script>
    /**
     * 分配
     * */
    function distribution(type) {
        let rows = $('#dg').datagrid('getSelections');
        if (rows.length < 1) {
            layer.alert("请选择需要分配的数据！", {
                icon: 2
            });
            return;
        }
        if ($("#id").val() == '') {
            for (let i = 0; i < rows.length; i++) {
                arr[rows[i].id].distribution = type;
            }
            $('#dg').datagrid('loadData', {total: arr.length, rows: arr});
            layer.alert('操作成功！', {
                icon: 1
            }, function () {
                layer.closeAll();
            });
        } else {
            for (let i = 0; i < rows.length; i++) {
                rows[i].distribution = type;
            }
            ajaxSubmit('/quality/book/distribution', rows);
        }
    }

    let allDict = {};
    let dictArr = [{typeCode: 'HEAT_TREATMENT_TYPE'},
        {typeCode: 'SALE_MATERIAL_SOURCE'},
        {typeCode: 'OUT_FACTORY_QUALITY'},
        {typeCode: 'SPLICING_QUALITY'}
    ];

    let arr = [];
    /**
     *
     * */
    $(function () {
        if (dictArr.length > 0) {
            ajaxDictQuery(dictArr, function (data) {
                allDict = data;
                setDictOption(['heatTreatmentType'], 'HEAT_TREATMENT_TYPE');
                setDictOption(['materialSource'], 'SALE_MATERIAL_SOURCE');
                setDictOption(['outFactory'], 'OUT_FACTORY_QUALITY');
                setDictOption(['splicing'], 'SPLICING_QUALITY');
            });
        }
    });

    function selectProcessingMethod(data) {
        $("#processingMethod").val(data.methodName);
    }

    /**
     * 弹出层
     * @param title
     * @param url
     * @param data
     */
    function openWindow(title, url, data) {
        layer.open({
            type: 2,
            title: title,
            fix: false,
            shadeClose: true,
            area: ['90%', '90%'],//width,height
            content: getRootPath() + url,
            btn: ['提交', '关闭'],
            success: function (layero, index) {
                let sonFrame = window['layui-layer-iframe' + index];
                if (data) {
                    sonFrame.init(data.id);
                } else {
                    sonFrame.init(null);
                }
            },
            yes: function (index, layero) {
                let obj = window[layero.find('iframe')[0]['name']].getFormData();
                //修改详情
                if ($("#id").val() != '') {
                    obj.qualityBookDataId = $("#id").val();
                    ajaxSubmit('/quality/book/updateDetail', obj);
                } else {
                    if (data != null) {//修改
                        arr = tempDataUpdate('dg', obj, arr);
                    } else {
                        arr = tempDataInsert('dg', obj, arr);
                    }
                }
            },
            btn2: function () {
                layer.closeAll();
            }
        });
    }

    function tableChange() {
        if ($("#sm1").is(':hidden')) {
            $("sm1").removeClass("selected");
            $("#sm1").show();
            $("#sm2").hide();
        } else {
            $("#sm1").hide();
            $("#sm2").show();
        }
    }

    function selectCustomer(data) {
        $("#customer").val(data.company);
        $("#customerId").val(data.id);
    }

    /**
     * 获取工艺卡数据
     * */
    function selectCode(data) {
        $("#processCardId").val(data.id);
        delete data.id;
        delete data.createTime;
        $('#form').form('load', data);
    }

    function selectMaterial(data) {
        $("#materialId").val(data.id);
        $("material").val(data.material);
    }

    function init(id) {
        if (id) {
            ajaxPostInvoke('/quality/book/queryOne', {id: id}, function (data) {
                let parameter = data.parameter;
                delete data.parameter;
                let obj = mergeJsonObject(data, parameter);
                $('#form').form('load', obj);
            });
            initTable(id);
        } else {
            let user = getUserInfo();
            $("#createUserName").val(user.username);
            $("#createTime").val(new Date());
            $("#createUser").val(user.userId);
            initTable(null);
        }
    }

    /**
     * 加载表格数据
     */
    function initTable(id) {
        let mWindHeight = $(window).height();
        let mContentHeight = mWindHeight - 100;
        $("#dg").datagrid({
            queryParams: {
                id: id
            },
            width: '98%',
            height: mContentHeight,
            singleSelect: false,
            autoRowHeight: false,
            rownumbers: true,
            showFooter: true,
            fitColumns: false,
            toolbar: '#toolbar',
            url: getRootPath() + '/quality/book/detailList',
            columns: [[{
                field: 'ck',
                checkbox: true
            }, {
                field: 'distribution',
                title: '分配',
                width: 100,
                align: 'left'
            }, {
                field: 'storage',
                title: '入库号',
                width: 100,
                align: 'left'
            }, {
                field: 'qualityWeight',
                title: '质量',
                width: 160,
                align: 'left'
            }, {
                field: 'circumference',
                title: '外圆周长',
                width: 100,
                align: 'left'
            }, {
                field: 'd1',
                title: 'd1',
                width: 100,
                align: 'left'
            }, {
                field: 'd2',
                title: 'd2',
                width: 100,
                align: 'left'
            }, {
                field: 'd3',
                title: 'd3',
                width: 100,
                align: 'left'
            }, {
                field: 'd4',
                title: 'd4',
                width: 100,
                align: 'left'
            }, {
                field: 'average',
                title: '平均',
                width: 100,
                align: 'left'
            }, {
                field: 'ellipse',
                title: '椭圆',
                width: 100,
                align: 'left'
            }, {
                field: 'tmin',
                title: 't1Mi',
                width: 100,
                align: 'left',
                formatter: function (value, row) {
                    return row.tmin == undefined ? row.tMin : row.tmin
                }
            }, {
                field: 'tmax',
                title: 't1Ma',
                width: 100,
                align: 'left',
                formatter: function (value, row) {
                    return row.tmax == undefined ? row.tMax : row.tmax
                }
            }, {
                field: 'timi',
                title: 'TiMi',
                width: 100,
                align: 'left',
                formatter: function (value, row) {
                    return value;
                }
            }, {
                field: 'allHeight',
                title: '总高',
                width: 100,
                align: 'left'
            }, {
                field: 'shapeA',
                title: '形状A',
                width: 100,
                align: 'left'
            }, {
                field: 'shapeB',
                title: '形状B',
                width: 100,
                align: 'left'
            }, {
                field: 'straightEdge',
                title: '直边斜',
                width: 100,
                align: 'left'
            }, {
                field: 'weldLine',
                title: '焊缝',
                width: 100,
                align: 'left'
            }]]
        });
    }

    /**
     * 获取数据
     */
    function getFormData() {
        let data = $("#form").getData();
        data.parameter = $("#form").getData();
        if (data.id == '') {
            data.desc = arr;
        }
        return data;
    }

    /**
     * 删除回调函数
     * @param row
     * @returns {boolean} 是否调用后台删除方法
     */
    function deleteInvoke(row) {
        if ($("#id").val() != '') {
            return true;
        }
        arr = tempDataDelete('dg', row, arr);
        console.log(arr);
        return false;
    }

    function search() {
        $('#dg').datagrid('reload', {id: $("#id").val()});
    }
</script>
